<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="/admin/common :: header" />
</head>
<body class="layui-layout-body">
<div id="LAY_app">
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header">
            <!-- 头部区域 -->
            <ul class="layui-nav layui-layout-left">
                <li class="layui-nav-item layadmin-flexible" lay-unselect>
                    <a href="javascript:;" layadmin-event="flexible" title="侧边伸缩">
                        <i class="layui-icon layui-icon-shrink-right" id="LAY_app_flexible"></i>
                    </a>
                </li>
                <li class="layui-nav-item layui-hide-xs" lay-unselect>
                    <a href="/" target="_blank" title="前台">
                        <i class="layui-icon layui-icon-website"></i>
                    </a>
                </li>
                <li class="layui-nav-item" lay-unselect>
                    <a href="javascript:;" layadmin-event="refresh" title="刷新">
                        <i class="layui-icon layui-icon-refresh-3"></i>
                    </a>
                </li>
                <li class="layui-nav-item layui-hide-xs" lay-unselect>
                    <input type="text" placeholder="全局搜索..." autocomplete="off" class="layui-input layui-input-search" layadmin-event="serach" lay-action="/search.html?keywords=">
                </li>
            </ul>
            <ul class="layui-nav layui-layout-right" lay-filter="layadmin-layout-right">

                <li class="layui-nav-item layui-hide-xs" lay-unselect>
                    <a href="javascript:;" layadmin-event="fullscreen">
                        <i class="layui-icon layui-icon-screen-full"></i>
                    </a>
                </li>
                <li class="layui-nav-item layui-hide-xs" lay-unselect>
                    <a href="javascript:;" layadmin-event="theme">
                        <i class="layui-icon layui-icon-theme"></i>
                    </a>
                </li>
                <li class="layui-nav-item layui-hide-xs" lay-unselect>
                    <a href="javascript:;" layadmin-event="clearcache">
                        <i class="layui-icon layui-icon-fonts-clear"></i>
                    </a>
                </li>
                <li class="layui-nav-item" lay-unselect>
                    <a href="javascript:;">
                        <cite>超级管理员</cite>
                    </a>
                    <dl class="layui-nav-child">
                      <!--  <dd><a lay-href="/admin/system/profile.html">基本资料</a></dd>-->
                        <dd><a lay-href="/admin/user/changepwd">修改密码</a></dd>
                        <hr>
                        <dd layadmin-event="logout" style="text-align: center;"><a>退出</a></dd>
                    </dl>
                </li>

                <li class="layui-nav-item layui-hide-xs" lay-unselect>
                    <a href="javascript:;" layadmin-event="about"><i class="layui-icon layui-icon-more-vertical"></i></a>
                </li>
                <li class="layui-nav-item layui-show-xs-inline-block layui-hide-sm" lay-unselect>
                    <a href="javascript:;" layadmin-event="more"><i class="layui-icon layui-icon-more-vertical"></i></a>
                </li>
            </ul>
        </div>

        <!-- 侧边菜单 -->
        <div class="layui-side layui-side-menu">
            <div class="layui-side-scroll">
                <div class="layui-logo" layadmin-event="refresh" title="刷新">
                    <span>后台权限细分系统</span>
                </div>
                <!--/菜单列表-->
               <!-- <ul class="layui-nav layui-nav-tree" lay-shrink="all" id="LAY-system-side-menu" lay-filter="layadmin-system-side-menu">
                    <li data-id='1' class='layui-nav-item'>
                        <a href='javascript:;' lay-tips='控制台' lay-direction='2'>
                            <i class='layui-icon layui-icon-console'></i>
                            <cite>控制台</cite>
                        </a>
                    </li>

                </ul>-->
                <ul class="layui-nav layui-nav-tree " lay-shrink="all" id="LAY-system-side-menu" lay-filter="layadmin-system-side-menu">

                </ul>
                <!--<div class="navBar layui-side-scroll" id="navBarId"></div>-->



            </div>
        </div>

        <!-- 页面标签 -->
        <div class="layadmin-pagetabs" id="LAY_app_tabs">
            <div class="layui-icon layadmin-tabs-control layui-icon-prev" layadmin-event="leftPage"></div>
            <div class="layui-icon layadmin-tabs-control layui-icon-next" layadmin-event="rightPage"></div>
            <div class="layui-icon layadmin-tabs-control layui-icon-down">
                <ul class="layui-nav layadmin-tabs-select" lay-filter="layadmin-pagetabs-nav">
                    <li class="layui-nav-item" lay-unselect>
                        <a href="javascript:;"></a>
                        <dl class="layui-nav-child layui-anim-fadein">
                            <dd layadmin-event="closeThisTabs"><a href="javascript:;">关闭当前标签页</a></dd>
                            <dd layadmin-event="closeOtherTabs"><a href="javascript:;">关闭其它标签页</a></dd>
                            <dd layadmin-event="closeAllTabs"><a href="javascript:;">关闭全部标签页</a></dd>
                        </dl>
                    </li>
                </ul>
            </div>
            <div class="layui-tab" lay-unauto lay-allowClose="true" lay-filter="layadmin-layout-tabs">
                <ul class="layui-tab-title" id="LAY_app_tabsheader">
                    <li lay-id="home/console.html" lay-attr="home/console.html" class="layui-this"><i class="layui-icon layui-icon-home"></i></li>
                </ul>
            </div>
        </div>


        <!-- 主体内容 -->
        <div class="layui-body" id="LAY_app_body">
            <div class="layadmin-tabsbody-item layui-show">
                <iframe th:src="@{/admin/main/welcome}" frameborder="0" class="layadmin-iframe"></iframe>
            </div>
        </div>

        <!-- 辅助元素，一般用于移动设备下遮罩 -->
        <div class="layadmin-body-shade" layadmin-event="shade"></div>
    </div>
</div>

<script th:src="@{/admin/layui/layui.js}"></script>
<script>
    layui.config({
        base: '/admin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use('index');


    layui.use(['jquery','element','layer'], function(){
        var $ = layui.jquery;
        var element = layui.element;
        var layer=layui.layer;
        $(function () {

            //递归获取导航栏无线层级
            var getChild=function (item,ulHtml) {
                ulHtml += '<dl class="layui-nav-child"  data-id=\""+child.id+""\">';
                $.each(item,function (index,child) {
                    if(child.children !=null&& child.children.length>0){
                        ulHtml +='<a>'+child.name+'</a>';
                        ulHtml +=getChild(child.children,"");
                    }else {
                        ulHtml += '<dd  data-id=\""+child.id+""\"><a href="javascript:;" lay-href="'+child.url+'" data-title="'+child.name+'" data-id="'+child.id+'" >';
                        ulHtml += '<cite>'+child.name+'</cite></a></dd>';
                    }

                });
                ulHtml += "</dl>"
                return ulHtml;
            };
            var loadindex=layer.msg('处理中...', {
                icon: 16
                ,shade: 0.01,
                time:0
            });
            $.ajax({
                url:"getmenu",
                success:function(res){
                    var data=res.data;
                    if(data!= "" && data.length>0){
                        var ulHtml = '';
                        if(data!= null&&data.length > 0){

                            $.each(data,function(index,item){
                                if(index == 0){
                                    ulHtml += '<li class="layui-nav-item layui-nav-itemed" data-id=\"+item.id+"\">';
                                }else{
                                    ulHtml += '<li class="layui-nav-item" data-id=\"+item.id+"\">';
                                }
                                ulHtml += '<a href="javascript:;">';
                                ulHtml += '<cite>'+item.name+'</cite>';
                                ulHtml += '</a>'
                                if(item.children != null && item.children.length > 0){
                                    ulHtml += '<dl class="layui-nav-child">';
                                    $.each(item.children,function(index,child){
                                        if(child.children !=null&& child.children.length>0){
                                            ulHtml +='<a>'+child.name+'</a>';
                                            ulHtml +=getChild(child.children,"");
                                        }else {
                                            ulHtml += '<dd><a href="javascript:;" lay-href="'+child.url+'" data-title="'+child.name+'" data-id="'+child.id+'" >';
                                            ulHtml += '<cite>'+child.name+'</cite></a></dd>';
                                        }

                                    });
                                    ulHtml += "</dl>"
                                }
                                ulHtml += '</li>'
                            });
                        }
                        ulHtml += '';
                        $(".layui-nav-tree").append(ulHtml);
                        element.init();  //初始化页面元素
                        layer.close(loadindex);

                    }else{
                        $(".layui-nav-tree").empty();
                        layer.close(loadindex);
                    }
                }
            });


        })})

</script>
</body>
</html>


